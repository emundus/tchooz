class TableColumns{constructor(t,e){this.$table=t,this.tableName=e,this.storageKey=`joomla-tablecolumns-${this.tableName}`,this.$headers=[].slice.call(t.querySelector("thead tr").children),this.$rows=t.querySelectorAll("tbody tr"),this.listOfHidden=[],this.loadState(),this.protectedCols=[0],this.$rows[0]&&[].slice.call(this.$rows[0].children).forEach((l,i)=>{if(l.nodeName==="TH"){this.protectedCols.push(i);const s=this.listOfHidden.indexOf(i);s!==-1&&this.listOfHidden.splice(s,1)}}),this.createControls(),this.listOfHidden.forEach(l=>{this.toggleColumn(l,!0)})}createControls(){const t=document.createElement("div");t.setAttribute("class","dropdown float-end pb-2");const e=document.createElement("div");e.setAttribute("class","dropdown-menu dropdown-menu-end"),e.setAttribute("data-bs-popper","static");const l=document.createElement("button");l.type="button",l.textContent=Joomla.Text._("JGLOBAL_COLUMNS"),l.classList.add("btn","btn-primary","btn-sm","dropdown-toggle"),l.setAttribute("data-bs-toggle","dropdown"),l.setAttribute("data-bs-auto-close","false"),l.setAttribute("aria-haspopup","true"),l.setAttribute("aria-expanded","false");const i=document.createElement("ul");i.setAttribute("class","list-unstyled p-2 text-nowrap mb-0"),i.setAttribute("id","columnList"),this.$headers.forEach((s,o)=>{if(o===0&&s.nodeName!=="TH")return;const h=document.createElement("li"),c=document.createElement("label"),n=document.createElement("input");n.classList.add("form-check-input","me-1"),n.type="checkbox",n.name="table[column][]",n.checked=this.listOfHidden.indexOf(o)===-1,n.disabled=this.protectedCols.indexOf(o)!==-1,n.value=o;let r=s.querySelector("span"),a=r?r.textContent.trim():"";a||(r=s.querySelector("span.visually-hidden")||s,a=r.textContent.trim()),a.includes(":")&&(a=a.split(":",2)[1].trim()),c.textContent=a,c.insertAdjacentElement("afterbegin",n),h.appendChild(c),i.appendChild(h)}),this.$table.insertAdjacentElement("beforebegin",t),t.appendChild(l),t.appendChild(e),e.appendChild(i),i.addEventListener("change",s=>{this.toggleColumn(parseInt(s.target.value,10)),this.saveState()}),this.$headers.forEach(s=>{s.classList.remove("d-none","d-xs-table-cell","d-sm-table-cell","d-md-table-cell","d-lg-table-cell","d-xl-table-cell","d-xxl-table-cell")}),this.$rows.forEach(s=>{[].slice.call(s.children).forEach(o=>{o.classList.remove("d-none","d-xs-table-cell","d-sm-table-cell","d-md-table-cell","d-lg-table-cell","d-xl-table-cell","d-xxl-table-cell")})}),this.$button=l,this.$menu=i,this.updateCounter()}updateCounter(){const t=this.$headers.length-1,e=t-this.listOfHidden.length;this.$button.textContent=`${e}/${t} ${Joomla.Text._("JGLOBAL_COLUMNS")}`}toggleColumn(t,e){if(!this.$headers[t]||this.protectedCols.indexOf(t)!==-1)return;const l=this.listOfHidden.indexOf(t);l===-1?this.listOfHidden.push(t):e!==!0&&this.listOfHidden.splice(l,1),this.$headers[t].classList.toggle("d-none",e),this.$rows.forEach(i=>{i.children[t].classList.toggle("d-none",e)}),this.updateCounter()}saveState(){window.localStorage.setItem(this.storageKey,this.listOfHidden.join(","))}loadState(){const t=window.localStorage.getItem(this.storageKey);t&&(this.listOfHidden=t.split(",").map(e=>parseInt(e,10)))}}window.innerWidth>992&&[...document.querySelectorAll("table:not(.columns-order-ignore)")].forEach(d=>{var t;const e=d.dataset.name?d.dataset.name:(t=document.querySelector(".page-title"))==null?void 0:t.textContent.trim().replace(/[^a-z0-9]/gi,"-").toLowerCase();e&&new TableColumns(d,e)});
