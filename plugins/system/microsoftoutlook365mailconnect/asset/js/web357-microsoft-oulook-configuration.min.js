function web357postForm(e,t={}){var o,n,i=document.createElement("form");for(o in i.method="POST",i.action=e,i.style.display="none",t[Joomla.getOptions("csrf.token")]=1,t)t.hasOwnProperty(o)&&((n=document.createElement("input")).type="hidden",n.name=o,n.value=t[o],i.appendChild(n));document.body.appendChild(i),i.submit()}function web357MicrosoftOutlookCopyToClipboard(e,t){document.getElementById(e).select(),document.execCommand("copy");var o=t.innerHTML;t.innerHTML='<span class="icon-checkmark" aria-hidden="true"></span>',setTimeout(function(){t.innerHTML=o},2e3)}document.addEventListener("DOMContentLoaded",function(){let t=Joomla.getOptions("web357.microsoft-outlook.js.configuration.script-options");var e=document.getElementById("web357-revoke-microsoft-token"),e=(e&&e.addEventListener("click",function(e){e.preventDefault(),web357postForm(t.actionRevokeToken,{revoke:1})}),document.getElementById("web357-microsoft-test-email"));e&&e.addEventListener("click",function(e){e.preventDefault(),web357postForm(t.actionTestEmail,{email:document.getElementById("web357_microsoft_test_email").value})})});